name: Docker Scout
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Build the Docker image
      run: docker build . --file Dockerfile --tag ${{ github.repository }}:$(date +%s)
    - name: Docker Scout
      id: docker-scout
      if: ${{ github.event_name == 'pull_request' }}
      uses: docker/scout-action@dd36f5b0295baffa006aa6623371f226cc03e506
      with:
        command: cves --ignore-base --format sarif --output ${{ github.repository }}.sarif.json
        image: ${{ github.repository }}:$(date +%s)
        ignore-unchanged: true
        token: ${{ secrets.DOCKERHUB_PAT }}
    - 
    
